#!/bin/bash

set -e

# Jump to the extension root directory.
cd "$(dirname "${BASH_SOURCE[0]}")/../.."

# Check if the ./ten/app directory exists.
if [ ! -d ".ten/app" ]; then
    echo "The ./ten/app directory does not exist. Please install it first."
    exit 1
fi

export LD_LIBRARY_PATH=$(pwd)/.ten/app/ten_packages/system/ten_runtime/lib

# Get the extension name according to pwd.
extension_name=$(basename "$(pwd)")
test_binary_name="${extension_name}_test"

exec bin/$test_binary_name "$@"
